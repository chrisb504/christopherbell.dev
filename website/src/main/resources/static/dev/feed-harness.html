<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Feed Item Harness</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="p-3">
  <div class="container">
    <h1 class="h4 mb-3">Feed Item Harness</h1>
    <div id="harness" class="list-group"></div>
  </div>
  <script type="module">
    import { createFeedItem } from '/js/lib/feed-render.js';
    import { sanitize, formatWhen } from '/js/lib/util.js';

    const testPosts = [
      { id: 'p1', username: 'alice', accountId: 'a1', text: 'Hello world', createdOn: new Date().toISOString(), level: 0, likesCount: 2, liked: false },
      { id: 'p2', username: 'bob', accountId: 'a2', text: 'Replying to hello', createdOn: new Date().toISOString(), level: 1, rootId: 'p1', likesCount: 5, liked: true },
    ];

    const harness = document.getElementById('harness');
    const fakeFetchRoot = async (rootId) => ({ username: 'alice', text: 'Hello world' });
    const noop = async () => ({ likesCount: 0, liked: false });
    const canDelete = () => true;

    for (const p of testPosts) {
      const el = createFeedItem(p, { sanitize, formatWhen, isLoggedIn: () => true, canDelete, fetchRoot: fakeFetchRoot, onLike: noop, onDelete: async () => {} });
      harness.appendChild(el);
    }
  </script>
</body>
</html>

